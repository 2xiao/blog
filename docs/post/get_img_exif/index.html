<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://2xiao.github.io/blog/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://2xiao.github.io/blog/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://2xiao.github.io/blog/css/github.min.css' />
    <link rel="stylesheet" href='https://2xiao.github.io/blog/css/github-style.css' />
    <link rel="stylesheet" href='https://2xiao.github.io/blog/css/light.css' />
    <link rel="stylesheet" href='https://2xiao.github.io/blog/css/dark.css' />
    <link rel="stylesheet" href='https://2xiao.github.io/blog/css/syntax.css' />
    <title>如何获取图片的版权信息 - 二小の博客</title>
    
    <link rel="icon" type="image/x-icon" href='https://2xiao.github.io/blog/images/favicon.ico'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="图片版权藏在哪儿
" />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://2xiao.github.io/blog/post/get_img_exif/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="如何获取图片的版权信息 - 二小の博客" />
<meta name="twitter:description"
  content="图片版权藏在哪儿
" />
<meta name="twitter:site" content="https://2xiao.github.io/blog" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://2xiao.github.io/blog">


<meta property="og:type" content="article" />
<meta property="og:title" content="如何获取图片的版权信息 - 二小の博客">
<meta property="og:description"
  content="图片版权藏在哪儿
" />
<meta property="og:url" content="https://2xiao.github.io/blog/post/get_img_exif/" />
<meta property="og:site_name" content="如何获取图片的版权信息" />
<meta property="og:image"
  content="https://2xiao.github.io/blog">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2017-06-18 10:53:37 &#43;0800 &#43;0800" />










</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://2xiao.github.io/blog">
        <svg class="octicon" height="32" viewBox="0 0 16 16" version="1.1" width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd"
            d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:https://2xiao.github.io/blog">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://2xiao.github.io/blog">
        <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
          width="32">
          <path fill-rule="evenodd"
            d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
          </path>
        </svg>
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>
  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://2xiao.github.io/blog">
                  <img class=" avatar-user"
                    src="https://2xiao.github.io/blog/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://2xiao.github.io/blog">二小</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://2xiao.github.io/blog/post/get_img_exif/">如何获取图片的版权信息</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Sun, 18 Jun 2017 10:53:37 &#43;0800"
                    class="no-wrap">
                    Sun, 18 Jun 2017 10:53:37 &#43;0800</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Sat, 16 Sep 2023 17:52:52 -0400"
                    class="no-wrap">
                    Sat, 16 Sep 2023 17:52:52 -0400</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div class="file-header d-flex flex-md-items-center flex-items-start">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    2486 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/javascript">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      JavaScript
                    </a>
                    
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5">
                <article class="markdown-body entry-content container-lg"><p>图片版权藏在哪儿</p>
<h3 id="1图片水印">1.图片水印</h3>
<p>一般见于图片左下角或右下角的水印logo</p>
<h3 id="2图片元数据">2.图片元数据</h3>
<p>数码图片由一组数字数据组成,记录着图片的像素、色彩、灰度等，除此之外，数码图片还有一组隐藏于幕后的数 字，这就是元数据（Data about Data，描述数据的数据）。图片元数据中记录着创作源设备、日期、位置、作者、版权等等。某些格式的图片如TIFF(tagged image file format)，JPG，PNG(portable network graphics)，EXIF (exchangeable image file)支持在文件中保存标 题、关键词、类别、作者、版权、URL等元数据，不影响图片的正常显示。可用于识别图片版权信息。使用Acdsee，Photoshop等图像软件都可加入这些信息，程序员还可以通过编程接口灵活添加这些信息。不过，利用图片元数据空间保存的图片版权信息，任何人都可以浏览修改，使它只能是一种辅助性或者隐蔽性的版权保护方法。</p>
<p>图 片 文 件 最 常 用 到 的 元 数 据 包 括 EXIF（ Exchangeable Image File Format，即可交换图像文件格式）和IPTC（Inter National Press Telecommunications Council，即国际出版 电讯委员会）。EXIF信息由图片生成设备产生，主要记录图片 生成设备的参数，比如光圈、快门、曝光时间、ISO感光值、焦 长等等。而IPTC信息包含了创作者姓名、版权信息、拍摄地 点、关键字等内容。图片创作者则可使用Acdsee，Photoshop等 图像编辑软件在EXIF或IPTC中添加相关信息以保护作品版权。 不过，图片元数据容量有限不适宜添加较多的信息内容，而且 使用元数据添加的信息很容易为其他用户修改，因此只能作为 一种辅助性的版权保护方法。</p>
<h3 id="3数字图像水印">3.数字图像水印</h3>
<p>数字水印技术是将一些 标识信息直接嵌入多媒体、文档、软件等数字载 体中，不影响原载体的使用价值，也不容易被人的知觉系统发现。通过这些隐藏在载体中的信息，可以达到确认内容创建者、购买者、传送隐秘 信息或者判断载体是否被篡改等目的。数字水印具有隐蔽性高、可以抵抗篡改、复制、压缩、转换、 滤波、重复添加等各种攻击的优点。目前已应用 于数字信息版权保护、印刷品防伪、信息来源追溯等领域。</p>
<h2 id="获取图片的元数据">获取图片的元数据</h2>
<p>使用<a href="https://github.com/2xiao/getExif/blob/master/exif.js">exif.js</a>提供的方法<code>EXIF.getData(img, callback)</code>和<code>EXIF.getAllIptcTags(img)</code>，如：</p>
<pre tabindex="0"><code>document.getElementById(&#34;file-input&#34;).onchange = function(e) {
    EXIF.getData(e.target.files[0], function() {
        var IptcObject = EXIF.getAllIptcTags(this);
        var IptcString = &#34;&#34;;
        for(var tag in IptcObject){
        	var IptcText = IptcObject[tag];
        	IptcString += tag + &#34; = &#34; + IptcText + &#34;&lt;br&gt;&#34;;
        }
        document.getElementById(&#34;output&#34;).innerHTML = IptcString;
    });
}
</code></pre><p>如图，要读取图片的IPTC信息：
<img src="http://ww4.sinaimg.cn/large/006tNc79ly1fftwu9cvqfj30p00iyn1x.jpg" alt=""></p>
<p><strong>提取出的版权信息为：</strong></p>
<blockquote>
<p>captionWriter = 李琰</p>
<p>keywords = 中国</p>
<p>headline = （一带一路·高峰论坛）习近平会见波兰总理希德沃</p>
<p>dateCreated = 20170512</p>
<p>copyright = 新华通讯社</p>
<p>category = 18</p>
<p>caption = 新华社照片，北京，2017年5月12日 习近平会见波兰总理希德沃 5月12日，国家主席习近平在北京人民大会堂会见来华出席“一带一路”国际合作高峰论坛的波兰总理希德沃。 新华社记者 谢环驰 摄</p>
<p>byline = 谢环驰</p>
</blockquote>
<h2 id="中文编码乱码">中文编码乱码</h2>
<p>在<a href="https://github.com/2xiao/getExif/blob/master/exif.js">exif.js</a>中，方法<code>readIPTCData()</code>中，返回值<code>fieldValue</code>由方法<code>getFinalStringFromDB()</code>得到，这个方法的作用是获取到图片中存储IPTC信息的位置信息后，对字节信息进行编码，得到字符信息，但是编码时需要对中英文字符分开处理。</p>
<pre tabindex="0"><code>function getFinalStringFromDB(buffer, start, length) {
    var outstr = &#34;&#34;;
    for (n = start; n &lt; start+length; ) {
        if(buffer.getUint8(n)&lt;127){
            outstr += String.fromCharCode(buffer.getUint8(n));
            n++;
        }else{
            var buffer10 = buffer.getUint16(n);
            var buffer16 = buffer10.toString(16).toUpperCase();
            var unicode10 = gbk2unicode(buffer16);
            var str = String.fromCharCode(unicode10);
            outstr += str;
            n += 2;
        }
    }
    return outstr
}
</code></pre><p>如果直接getUint8()，getUint8()每8个比特提取为一个字，非汉字是正确的，但是直接将汉字分为两个Unicode，则图片中的汉字被编译成拉丁文</p>
<pre tabindex="0"><code>function getStringFromDB(buffer, start, length) {
    var outstr = &#34;&#34;;
    for (n = start; n &lt; start+length; n++) {
        outstr += String.fromCharCode(buffer.getUint8(n));
    }
    return outstr;
}

// captionWriter = Àîçü
// keywords = ÖÐ¹ú
// headline = £¨Ò»´øÒ»Â·¡¤¸ß·åÂÛÌ³£©Ï°½üÆ½»á¼û²¨À¼×ÜÀíÏ£µÂÎÖ
// dateCreated = 20170512
// copyright = ÐÂ»ªÍ¨Ñ¶Éç
// category = 18
// caption = ÐÂ»ªÉçÕÕÆ¬£¬±±¾©£¬2017Äê5ÔÂ12ÈÕ Ï°½üÆ½»á¼û²¨À¼×ÜÀíÏ£µÂÎÖ 5ÔÂ12ÈÕ£¬¹ú¼ÒÖ÷Ï¯Ï°½üÆ½ÔÚ±±¾©ÈËÃñ´ó»áÌÃ»á¼ûÀ´»ª³öÏ¯¡°Ò»´øÒ»Â·¡±¹ú¼ÊºÏ×÷¸ß·åÂÛÌ³µÄ²¨À¼×ÜÀíÏ£µÂÎÖ¡£ ÐÂ»ªÉç¼ÇÕß Ð»»·³Û Éã
// byline = Ð»»·³Û
</code></pre><p>如果直接getUint16()，则每16个比特提取为一个字，能提取出汉字，但是对应关系错误，因为此时还没有修改<code>n</code>，相当于每次还只向后挪动8bytes，所以还要修改<code>n</code>和<code>length</code>：</p>
<pre tabindex="0"><code>function getFinalStringFromDB(buffer, start, length) {
    var outstr = &#34;&#34;;
    length = length/2;
    for (n = start; n &lt; start+length; ) {
        var buffer10 = buffer.getUint16(n);
        var buffer16 = buffer10.toString(16).toUpperCase();
        var unicode10 = gbk2unicode(buffer16);
        outstr += String.fromCharCode(unicode10);
    }
    return outstr
}

// captionWriter = 李铉
// keywords = 中泄
// headline = 一淮带一宦路贰高叻峰迓论厶坛常习
// dateCreated =
// copyright = 新禄华通
// category =
// caption = 新禄华社缯照掌片北本京年月日习敖近平交会峒见波兰甲总芾理硐希德挛沃月日眨国家抑主飨席习敖近平皆在诒北本京
// byline = 谢换环
</code></pre><p>修改n和length，因为n的位置应该向后移动两个比特，所以作出修改，此时汉字部分正确，但是非汉字部分解码错误</p>
<pre tabindex="0"><code>function getFinalStringFromDB(buffer, start, length) {
    var outstr = &#34;&#34;;
    for (n = start; n &lt; start+length; ) {
        var buffer10 = buffer.getUint16(n);
        var buffer16 = buffer10.toString(16).toUpperCase();
        var unicode10 = gbk2unicode(buffer16);
        outstr += String.fromCharCode(unicode10);
        n += 2;
    }
    return outstr
}

// captionWriter = 李琰
// keywords = 中国
// headline = 一带一路高峰论坛习近平会见波兰总理希德沃
// dateCreated =
// copyright = 新华通讯社
// category =
// caption = 新华社照片北京年习近平会见波兰总理希德沃月日国家主席习近平在北京人民大会堂会见来华出席一带一路国际合作高峰论坛的波兰总理希德沃禄缂钦谢环驰
// byline = 谢环驰
</code></pre><p>修改if判断，对应关系是两个拉丁文字符对应一个汉字，一个汉字占16比特，一个非汉字只占8比特，所以要进行判断，当<code>Unicode&gt;127</code>时，代表此处和后面的8bytes组成一个汉字，当<code>Unicode&lt;127</code>时，代表此处是英文字符。</p>
<pre tabindex="0"><code>function getFinalStringFromDB(buffer, start, length) {
    var outstr = &#34;&#34;;
    for (n = start; n &lt; start+length; ) {
        if(buffer.getUint8(n)&lt;127){
            outstr += String.fromCharCode(buffer.getUint8(n));
            n++;
        }else{
            var buffer10 = buffer.getUint16(n);
            var buffer16 = buffer10.toString(16).toUpperCase();
            var unicode10 = gbk2unicode(buffer16);
            var str = String.fromCharCode(unicode10);
            outstr += str;
            n += 2;
        }
    }
    return outstr
}
// captionWriter = 李琰
// keywords = 中国
// headline = 一带一路高峰论坛习近平会见波兰总理希德沃
// dateCreated = 20170512
// copyright = 新华通讯社
// category = 18
// caption = 新华社照片北京2017年5月12日 习近平会见波兰总理希德沃 5月12日国家主席习近平在北京人民大会堂会见来华出席一带一路国际合作高峰论坛的波兰总理希德沃 新华社记者 谢环驰 摄
// byline = 谢环驰
</code></pre><p>至此，成功解决了中文编码乱码的问题。</p></article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://2xiao.github.io/blog">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0"><a href='https://github.com/2xiao'>2xiao</a> の blog</li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="https://2xiao.github.io/blog/js/github-style.js"></script>



</html>